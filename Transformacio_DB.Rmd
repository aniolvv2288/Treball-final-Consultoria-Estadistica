---
title: "Anàlisi descriptiva"
author: "Segon Salmerón Èric (1672984)"
date: "2026-01-09"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Transformació de variables
```{r}
dades<- readRDS("dfcomplet.rds")
```

### Eliminació variables no informatives

\begin{enumerate}
  \item \textbf{proces:} Tipus de procés electoral (En aquest cas només hi ha eleccions generals codificades amb 02).
  \item \textbf{volta:} Prèn el mateix valor que `mes`
  \item \textbf{ccaa:} Comunitat autònoma de la secció censal (En aquest cas sempre és Catalunya, codificada amb 09).
  \item \textbf{municipi:} Conté el codi del municipi, però es una variable redundant ja que tenim una altra `codi_municipi` amb la mateixa infomració
\end{enumerate}

```{r}
dades <- subset(dades, select = -c(proces, volta, ccaa, municipi))
```


### Variable ´eleccio`

Com l'any 2019 hi van haver dues eleccions generals (a l'abril i al novembre), per referir-nos a cada elecció concreta hem d'usar una combinació de les variables `any`i `mes`.

```{r}
dades$eleccio <- paste0(
  dades$any, "_",
  ifelse(dades$mes == "04",  "abr",
  ifelse(dades$mes == "06",  "jun",
  ifelse(dades$mes == "07",  "jul",
  ifelse(dades$mes == "11", "nov",
  ifelse(dades$mes == "12", "des", NA)))))
)

#Fem que sigui un factor ordenat
nivells_eleccio <- unique(dades$eleccio[order(dades$any, dades$mes)])

dades$eleccio <- factor(dades$eleccio, levels = nivells_eleccio, ordered = TRUE)

```

### Correcció del tipus de variable

Correcció de variables que no són del tipus esperat

```{r}
dades <- dades %>%
  mutate(
    
    #Numèriques
    any = as.numeric(any), #Variable temporal
    mes = as.numeric(mes), #Variable temporal
    
    #Factors
    candidatura     = factor(candidatura),
    provincia        = factor(provincia),
    districte        = factor(districte),
    seccio           = factor(seccio),
    tipus            = factor(tipus),
    sigles           = factor(sigles),
    nom_partit       = factor(nom_partit),
    Municipi         = factor(Municipi),
    Codi_municipi    = factor(Codi_municipi),
    Districte        = factor(Districte),
  )

```


### Factorització de variables numèriques

De cara a la descripció de la base de dades i a la modelització és interessant tenir també una versió en factor de certes variables numèriques. Els punts de tall del factor vindran determinats pels tercils, quartils o quintils, en funció de en quants grups sigui adient segmentar en cada cas.


fac_Edad media, fac_Población, fac_Tamaño_medio_del_hogar, fac_renta_media_bruta_por_persona, fac_renta_media_bruta_por_hogar

#### Edat

Petita descripció:
```{r}
## Summary
summary(dades[["Edad media de la población"]])

hist(
  dades[["Edad media de la población"]],
  main = "Edat mitjana de la població",
  xlab = "Edat mitjana (anys)",
  breaks = 30
)
```


Punts de tall establerts amb criteri social interpretatiu:

$\text{Mitjana edat} < 40 = \text{Secció jove}$

$40 < \text{Mitjana edat} < 45 = \text{Secció d'edat mitjana}$

$\text{Mitjana edat} > 45 = \text{Secció jove}$

```{r}
dades$fac_Edad_media <- cut(
  dades[["Edad media de la población"]],
  breaks = c(-Inf, 40, 45, Inf),
  labels = c("Secció jove", "Secció d'edat mitjana", "Secció envellida"),
  include.lowest = TRUE
)

plot(dades$fac_Edad_media)
```


### Nombre total de vots de cada partit en cada elecció

Gràfic de barres en que l'eix Y sigui nombre de vots, i l'eix X siguin els diferents partits. Cada partit hauria de tenir 5 barres, una per elecció (anys 2015, 2016, 2019_abr, 2019_nov, 2023).

